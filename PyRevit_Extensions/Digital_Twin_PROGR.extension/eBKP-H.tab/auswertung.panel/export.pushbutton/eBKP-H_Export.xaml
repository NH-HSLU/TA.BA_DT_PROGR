<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="BKP Export - Elementauswahl"
        Height="800" Width="600"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResizeWithGrip">

    <Window.Resources>
        <Style TargetType="CheckBox">
            <Setter Property="Margin" Value="5,2"/>
        </Style>
        <Style TargetType="Button">
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="Margin" Value="5"/>
        </Style>
    </Window.Resources>

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,10">
            <TextBlock Text="eBKP-H Export - Elementauswahl" FontSize="18" FontWeight="Bold"/>
            <TextBlock Text="Wählen Sie die zu exportierenden Elemente aus den verfügbaren Dokumenten"
                       Foreground="Gray" Margin="0,5,0,0"/>
        </StackPanel>

        <!-- Main Content: TreeView mit Dokumenten und Kategorien -->
        <Border Grid.Row="1" BorderBrush="LightGray" BorderThickness="1" CornerRadius="3">
            <TreeView x:Name="treeDocuments" Margin="5">
                <TreeView.ItemTemplate>
                    <HierarchicalDataTemplate ItemsSource="{Binding Categories}">
                        <!-- Dokument-Ebene -->
                        <StackPanel Orientation="Horizontal">
                            <CheckBox IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                      Click="DocCheckbox_Click"/>
                            <TextBlock Text="{Binding Icon}" Margin="5,0" FontSize="14"/>
                            <TextBlock Text="{Binding Name}" FontWeight="SemiBold"/>
                            <TextBlock Text="{Binding ElementCount, StringFormat=' ({0} Elemente)'}"
                                       Foreground="Gray"/>
                        </StackPanel>

                        <!-- Kategorie-Ebene -->
                        <HierarchicalDataTemplate.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <CheckBox IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                              Click="CategoryCheckbox_Click"/>
                                    <TextBlock Text="{Binding Name}" Margin="5,0"/>
                                    <TextBlock Text="{Binding Count, StringFormat=' [{0}]'}"
                                               Foreground="DarkBlue" FontWeight="SemiBold"/>
                                </StackPanel>
                            </DataTemplate>
                        </HierarchicalDataTemplate.ItemTemplate>
                    </HierarchicalDataTemplate>
                </TreeView.ItemTemplate>
            </TreeView>
        </Border>

        <!-- Zusammenfassung -->
        <Border Grid.Row="2" Background="#F5F5F5" Padding="10" Margin="0,10,0,0" CornerRadius="3">
            <StackPanel>
                <TextBlock Text="Zusammenfassung" FontWeight="Bold" Margin="0,0,0,5"/>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Ausgewählte Dokumente: "/>
                    <TextBlock x:Name="txtSelectedDocs" Text="0" FontWeight="Bold" Foreground="DarkBlue"/>
                    <TextBlock Text="  |  Ausgewählte Kategorien: " Margin="20,0,0,0"/>
                    <TextBlock x:Name="txtSelectedCats" Text="0" FontWeight="Bold" Foreground="DarkBlue"/>
                    <TextBlock Text="  |  Geschätzte Elemente: " Margin="20,0,0,0"/>
                    <TextBlock x:Name="txtTotalElements" Text="0" FontWeight="Bold" Foreground="DarkGreen"/>
                </StackPanel>
            </StackPanel>
        </Border>

        <!-- Buttons -->
        <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
            <Button x:Name="btnSelectAll" Content="Alle auswählen" Click="SelectAll_Click"/>
            <Button x:Name="btnSelectNone" Content="Keine auswählen" Click="SelectNone_Click"/>
            <Button x:Name="btnExport" Content="Exportieren" IsDefault="True"
                    Background="#0078D4" Foreground="White" Click="Export_Click"/>
            <Button x:Name="btnCancel" Content="Abbrechen" IsCancel="True" Click="Cancel_Click"/>
        </StackPanel>
    </Grid>
</Window>
